<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>American Corner Mahajanga - Syst√®me Complet</title>
    
    <!-- Biblioth√®ques -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.8/html5-qrcode.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showPage('home')">
                <i class="fas fa-university me-2"></i>
                American Corner Mahajanga
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" onclick="showPage('home')">Accueil</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('about')">√Ä Propos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('attendance')">Pr√©sence</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('qr-generator')">QR Codes</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('members')">Membres</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('contact')">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Home Page -->
    <section id="home" class="page-section active">
        <div class="hero-section">
            <div class="container">
                <h1 class="display-4 fw-bold mb-4">American Corner Mahajanga</h1>
                <p class="lead mb-4">Votre porte d'entr√©e vers l'√©ducation, la culture et l'information am√©ricaine √† Mahajanga, Madagascar</p>
                <button class="btn btn-light btn-lg px-4 me-2" onclick="showPage('about')">En Savoir Plus</button>
                <button class="btn btn-outline-light btn-lg px-4" onclick="showPage('attendance')">Check-In</button>
            </div>
        </div>

        <!-- Services Preview -->
        <section class="py-5">
            <div class="container">
                <h2 class="section-title text-center">Nos Services</h2>
                <div class="row g-4">
                    <div class="col-md-6 col-lg-3">
                        <div class="card service-card text-center p-4">
                            <div class="service-icon">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <h4>Conseil √âducatif</h4>
                            <p>Guidance gratuite pour les √©tudiants malgaches int√©ress√©s par les √©tudes aux √âtats-Unis.</p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <div class="card service-card text-center p-4">
                            <div class="service-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <h4>Ressources Biblioth√®que</h4>
                            <p>Acc√®s aux livres, magazines et ressources num√©riques sur la culture am√©ricaine.</p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <div class="card service-card text-center p-4">
                            <div class="service-icon">
                                <i class="fas fa-language"></i>
                            </div>
                            <h4>Programmes d'Anglais</h4>
                            <p>Clubs de conversation, ateliers et ressources pour apprendre l'anglais.</p>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <div class="card service-card text-center p-4">
                            <div class="service-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <h4>Programmes Culturels</h4>
                            <p>√âv√©nements, projections de films et ateliers c√©l√©brant la culture am√©ricaine.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quick Access -->
        <section class="py-5 bg-light">
            <div class="container">
                <h2 class="section-title text-center">Acc√®s Rapide</h2>
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="card text-center p-4">
                            <i class="fas fa-qrcode fa-3x text-primary mb-3"></i>
                            <h4>Syst√®me de Pr√©sence</h4>
                            <p>Check-in avec QR code pour le suivi des pr√©sences</p>
                            <button class="btn btn-primary mt-2" onclick="showPage('attendance')">Acc√©der</button>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center p-4">
                            <i class="fas fa-id-card fa-3x text-primary mb-3"></i>
                            <h4>G√©n√©rateur QR</h4>
                            <p>Cr√©ez des QR codes personnalis√©s pour les membres</p>
                            <button class="btn btn-primary mt-2" onclick="showPage('qr-generator')">G√©n√©rer</button>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center p-4">
                            <i class="fas fa-users fa-3x text-primary mb-3"></i>
                            <h4>Gestion Membres</h4>
                            <p>Consultez la liste des membres et leurs profils</p>
                            <button class="btn btn-primary mt-2" onclick="showPage('members')">Voir</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </section>

    <!-- About Page -->
    <section id="about" class="page-section py-5">
        <div class="container">
            <button class="btn btn-outline-primary mb-4" onclick="showPage('home')">
                <i class="fas fa-arrow-left me-2"></i>Retour √† l'Accueil
            </button>
            <h2 class="section-title text-center">√Ä Propos de Nous</h2>
            <div class="row align-items-center">
                <div class="col-md-6 mb-4">
                    <p class="lead">American Corner Mahajanga est un centre culturel et d'information situ√© √† Mahajanga (Majunga), Madagascar. C'est un partenariat entre l'Ambassade des √âtats-Unis √† Madagascar et l'Universit√© de Mahajanga.</p>
                    <p>Nous servons de ressource pour les √©tudiants, les professionnels et le grand public qui s'int√©ressent aux √âtats-Unis, sa culture, son syst√®me √©ducatif et ses politiques.</p>
                    <p>Les American Corners font partie d'une initiative mondiale du D√©partement d'√âtat am√©ricain pour fournir une fen√™tre sur les √âtats-Unis dans les villes o√π il n'y a pas de Centre am√©ricain complet ou d'Ambassade.</p>
                    <p>Notre mission est de promouvoir la compr√©hension mutuelle entre les peuples de Madagascar et des √âtats-Unis gr√¢ce √† des programmes √©ducatifs et culturels.</p>
                </div>
                <div class="col-md-6">
                    <img src="https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Students at American Corner" class="img-fluid rounded shadow">
                </div>
            </div>
        </div>
    </section>

    <!-- Attendance System Page - MODIFI√â POUR SCANNER.JS -->
    <section id="attendance" class="page-section py-5">
        <div class="container">
            <button class="btn btn-outline-primary mb-4" onclick="showPage('home')">
                <i class="fas fa-arrow-left me-2"></i>Retour √† l'Accueil
            </button>
            <h2 class="section-title text-center">Syst√®me de Pr√©sence ACM</h2>
            
            <!-- Alerts -->
            <div id="attendanceAlert" class="alert alert-attendance" style="display: none;"></div>
            
            <!-- Scanner Status -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="scanner-status text-center">
                        <span class="badge bg-secondary" id="scannerStatus">Scanner arr√™t√©</span>
                    </div>
                </div>
            </div>

            <!-- QR Scanner Section - STRUCTURE MODIFI√âE -->
            <div class="card attendance-card">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0"><i class="fas fa-qrcode me-2"></i>Check-in par QR Code</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="qr-scanner-container">
                                <h5>Scannez Votre QR Code Membre</h5>
                                
                                <!-- Scanner Container - STRUCTURE SIMPLIFI√âE -->
                                <div id="scannerSection">
                                    <!-- Camera Placeholder - visible par d√©faut -->
                                    <div class="camera-placeholder" id="cameraPlaceholder">
                                        <i class="fas fa-camera fa-3x mb-3"></i>
                                        <p>Scanner pr√™t</p>
                                        <small class="text-muted mt-2">Cliquez pour activer le scanner</small>
                                    </div>
                                    
                                    <!-- Scanner Container - cach√© par d√©faut -->
                                    <div id="scannerContainer" style="display: none;"></div>
                                    
                                    <!-- Scanner Controls -->
                                    <div class="scanner-controls mt-3">
                                        <button class="btn btn-primary w-100" id="startScannerBtn">
                                            <i class="fas fa-camera me-2"></i>Activer le Scanner
                                        </button>
                                        <button class="btn btn-secondary w-100" id="stopScannerBtn" style="display: none;">
                                            <i class="fas fa-stop me-2"></i>Arr√™ter le Scanner
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Manual Entry -->
                                <button class="btn btn-outline-primary mt-3 w-100" onclick="qrScanner.startManualEntry()">
                                    <i class="fas fa-keyboard me-2"></i>Entr√©e Manuelle
                                </button>
                                
                                <!-- Quick Demo -->
                                <div class="mt-3 p-3 bg-light rounded">
                                    <h6>Mode D√©mo</h6>
                                    <p class="small mb-2">Testez le syst√®me avec des donn√©es locales</p>
                                    <button class="btn btn-outline-info btn-sm w-100" onclick="testScannerWithDemoMember()">
                                        Utiliser ACM001 (Linus Torvalds)
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="p-4">
                                <h5>Comment Check-in</h5>
                                <ol class="list-group list-group-numbered mb-4">
                                    <li class="list-group-item">Obtenez votre QR code personnel</li>
                                    <li class="list-group-item">Activez le scanner cam√©ra</li>
                                    <li class="list-group-item">Scannez votre QR code</li>
                                    <li class="list-group-item">Remplissez les d√©tails de votre visite</li>
                                    <li class="list-group-item">Confirmez votre check-in</li>
                                </ol>
                                
                                <!-- Check-in Interface will be injected here by scanner.js -->
                                <div id="checkinInterfaceContainer">
                                    <!-- L'interface de check-in sera inject√©e ici dynamiquement -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Active Sessions -->
            <div class="card attendance-card mt-4">
                <div class="card-header bg-success text-white">
                    <h4 class="mb-0"><i class="fas fa-history me-2"></i>Check-ins R√©cents</h4>
                </div>
                <div class="card-body">
                    <div id="recentCheckinsContainer">
                        <p class="text-muted text-center">Aucun check-in r√©cent</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- QR Generator Page -->
    <section id="qr-generator" class="page-section py-5">
        <div class="container">
            <button class="btn btn-outline-primary mb-4" onclick="showPage('home')">
                <i class="fas fa-arrow-left me-2"></i>Retour √† l'Accueil
            </button>
            <h2 class="section-title text-center">G√©n√©rateur de QR Codes</h2>
            
            <div class="alert alert-info">
                <i class="fas fa-info-circle me-2"></i>
                <strong>Format API:</strong> Les QR codes g√©n√©r√©s utilisent le format exact de votre API pour une compatibilit√© parfaite avec le syst√®me d'attendance.
            </div>
            
            <!-- QR Generator Form -->
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0"><i class="fas fa-qrcode me-2"></i>G√©n√©rer un QR Code Membre</h4>
                </div>
                <div class="card-body">
                    <form id="qrGeneratorForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="registrationNumber" class="form-label">Num√©ro d'Enregistrement *</label>
                                    <input type="text" class="form-control" id="registrationNumber" required 
                                           placeholder="ex: ACM001, ACM002">
                                    <div class="form-text">Doit correspondre au registrationNumber de l'API</div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="firstName" class="form-label">Pr√©nom *</label>
                                    <input type="text" class="form-control" id="firstName" required 
                                           placeholder="ex: Linus">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="lastName" class="form-label">Nom *</label>
                                    <input type="text" class="form-control" id="lastName" required 
                                           placeholder="ex: Torvalds">
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="occupation" class="form-label">Occupation</label>
                                    <select class="form-select" id="occupation">
                                        <option value="student">√âtudiant</option>
                                        <option value="employee">Employ√©</option>
                                        <option value="entrepreneur">Entrepreneur</option>
                                        <option value="unemployed">Sans emploi</option>
                                        <option value="other">Autre</option>
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="phoneNumber" class="form-label">T√©l√©phone</label>
                                    <input type="tel" class="form-control" id="phoneNumber" 
                                           placeholder="ex: +261 34 12 345 67">
                                </div>
                                
                                <div class="mb-3">
                                    <label for="studyWorkPlace" class="form-label">Lieu d'√âtude/Travail</label>
                                    <input type="text" class="form-control" id="studyWorkPlace" 
                                           placeholder="ex: Universit√© de Mahajanga">
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center mt-4">
                            <button type="submit" class="btn btn-primary btn-lg" id="generateQRBtn">
                                <i class="fas fa-qrcode me-2"></i>G√©n√©rer QR Code
                            </button>
                            <button type="button" class="btn btn-outline-secondary btn-lg ms-2" id="clearQRBtn">
                                <i class="fas fa-eraser me-2"></i>Effacer
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- QR Code Display -->
            <div class="card" id="qrCodeSection" style="display: none;">
                <div class="card-header bg-success text-white">
                    <h4 class="mb-0"><i class="fas fa-check-circle me-2"></i>QR Code G√©n√©r√©</h4>
                </div>
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <div class="qr-code-display">
                                <div id="qrcode"></div>
                                <div class="mt-3">
                                    <button class="btn btn-success me-2" id="downloadQRBtn">
                                        <i class="fas fa-download me-2"></i>T√©l√©charger
                                    </button>
                                    <button class="btn btn-outline-primary" id="printQRBtn">
                                        <i class="fas fa-print me-2"></i>Imprimer
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="member-info">
                                <h5>Informations Membre</h5>
                                <div class="card">
                                    <div class="card-body">
                                        <p><strong>Num√©ro:</strong> <span id="displayRegNumber" class="member-id-display">-</span></p>
                                        <p><strong>Nom:</strong> <span id="displayName">-</span></p>
                                        <p><strong>Occupation:</strong> <span id="displayOccupation">-</span></p>
                                        <p><strong>T√©l√©phone:</strong> <span id="displayPhone">-</span></p>
                                        <p><strong>Lieu:</strong> <span id="displayStudyWork">-</span></p>
                                        <p><strong>G√©n√©r√©:</strong> <span id="displayTimestamp">-</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <h5>Contenu du QR Code (Format API):</h5>
                        <pre class="bg-light p-3 rounded"><code id="jsonPreview"></code></pre>
                    </div>
                </div>
            </div>

            <!-- Sample Members Section -->
            <div class="card mt-4">
                <div class="card-header bg-info text-white">
                    <h4 class="mb-0"><i class="fas fa-users me-2"></i>Membres ACM - Pr√™ts √† Scanner</h4>
                </div>
                <div class="card-body">
                    <p class="text-center mb-4">Cliquez sur un membre pour g√©n√©rer instantan√©ment son QR code</p>
                    
                    <div class="row g-4" id="sampleMembers">
                        <!-- Sample members will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Members Page -->
    <section id="members" class="page-section py-5">
        <div class="container">
            <button class="btn btn-outline-primary mb-4" onclick="showPage('home')">
                <i class="fas fa-arrow-left me-2"></i>Retour √† l'Accueil
            </button>
            <h2 class="section-title text-center">Nos Membres</h2>
            <p class="text-center mb-5">D√©couvrez nos membres d√©di√©s qui participent aux activit√©s de l'American Corner.</p>
            
            <div class="row g-4" id="membersContainer">
                <!-- Members will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Contact Page -->
    <section id="contact" class="page-section py-5 bg-light">
        <div class="container">
            <button class="btn btn-outline-primary mb-4" onclick="showPage('home')">
                <i class="fas fa-arrow-left me-2"></i>Retour √† l'Accueil
            </button>
            <h2 class="section-title text-center">Contactez-Nous</h2>
            <div class="row">
                <div class="col-md-6 mb-4">
                    <div class="card h-100">
                        <div class="card-body">
                            <h4 class="mb-4">Coordonn√©es</h4>
                            <div class="mb-3">
                                <h5><i class="fas fa-map-marker-alt me-2 text-primary"></i> Adresse</h5>
                                <p>Universit√© de Mahajanga<br>Mahajanga, R√©gion Boeny<br>Madagascar</p>
                            </div>
                            <div class="mb-3">
                                <h5><i class="fas fa-envelope me-2 text-primary"></i> Email</h5>
                                <p>info@americancornermahajanga.mg</p>
                            </div>
                            <div class="mb-3">
                                <h5><i class="fas fa-phone me-2 text-primary"></i> T√©l√©phone</h5>
                                <p>+261 XX XX XXX XX</p>
                            </div>
                            <div class="mb-3">
                                <h5><i class="fas fa-clock me-2 text-primary"></i> Heures d'Ouverture</h5>
                                <p>Lundi - Vendredi: 9h00 - 17h00<br>Samedi: 9h00 - 13h00</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card h-100">
                        <div class="card-body">
                            <h4 class="mb-4">Envoyez un Message</h4>
                            <form id="contactForm">
                                <div class="mb-3">
                                    <label for="name" class="form-label">Nom</label>
                                    <input type="text" class="form-control" id="name" required>
                                </div>
                                <div class="mb-3">
                                    <label for="email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="email" required>
                                </div>
                                <div class="mb-3">
                                    <label for="subject" class="form-label">Sujet</label>
                                    <input type="text" class="form-control" id="subject" required>
                                </div>
                                <div class="mb-3">
                                    <label for="message" class="form-label">Message</label>
                                    <textarea class="form-control" id="message" rows="4" required></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary px-4" id="sendMessageBtn">Envoyer</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4 mb-md-0">
                    <h5>American Corner Mahajanga</h5>
                    <p>Un partenariat entre l'Ambassade des √âtats-Unis √† Madagascar et l'Universit√© de Mahajanga.</p>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="col-md-4 mb-4 mb-md-0">
                    <h5>Liens Rapides</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white text-decoration-none" onclick="showPage('home')">Accueil</a></li>
                        <li><a href="#" class="text-white text-decoration-none" onclick="showPage('about')">√Ä Propos</a></li>
                        <li><a href="#" class="text-white text-decoration-none" onclick="showPage('attendance')">Pr√©sence</a></li>
                        <li><a href="#" class="text-white text-decoration-none" onclick="showPage('qr-generator')">QR Codes</a></li>
                        <li><a href="#" class="text-white text-decoration-none" onclick="showPage('contact')">Contact</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5>Ressources</h5>
                    <ul class="list-unstyled">
                        <li><a href="https://mg.usembassy.gov" class="text-white text-decoration-none">Ambassade USA Madagascar</a></li>
                        <li><a href="https://educationusa.state.gov" class="text-white text-decoration-none">EducationUSA</a></li>
                        <li><a href="https://exchanges.state.gov" class="text-white text-decoration-none">Programmes d'√âchange</a></li>
                    </ul>
                </div>
            </div>
            <hr class="mt-4 mb-3">
            <div class="row">
                <div class="col-md-12 text-center">
                    <p class="mb-0">&copy; 2024 American Corner Mahajanga. Tous droits r√©serv√©s.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Custom JavaScript -->
    <script src="js/api.js"></script>
    <script src="js/scanner.js"></script>
    <script src="js/attendance.js"></script>
    <script src="js/qr-generator.js"></script>
    <script src="js/members.js"></script>
    <script src="js/app.js"></script>

    <script>
        // Fonction utilitaire pour tester le scanner
        function testScannerWithDemoMember() {
            console.log('üß™ Test avec membre d√©mo ACM001');
            // Simuler un scan r√©ussi avec ACM001
            const demoQRData = JSON.stringify({
                registrationNumber: "ACM001",
                firstName: "Linus",
                lastName: "Torvalds",
                occupation: "entrepreneur",
                phoneNumber: "+261 34 11 223 34",
                studyOrWorkPlace: "Linux Foundation",
                timestamp: new Date().toISOString()
            });
            
            // D√©clencher le scan manuellement
            if (window.qrScanner && window.qrScanner.onScanSuccess) {
                window.qrScanner.onScanSuccess(demoQRData);
            }
        }
    </script>
</body>
</html>